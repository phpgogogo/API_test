<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
        integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <!-- datatable -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.css">




</head>

<body>
    <div class="container">
        <div>
            <button id="all">全部</button>
            <button id="north">北部</button>
            <button id="mid">中部</button>
            <button id="south">南部</button>
            <button id="east">東部</button>
        </div>
        <h1 class="text-center">各縣市累積降雨量</h1>
        <table id="table_id" class="table table-hover table-striped text-center">
            <thead>
                <tr>
                    <th>id</th>
                    <th>縣市</th>
                    <th>時間1</th>
                    <th>時間2</th>
                    <th>時間3</th>
                    <th>時間4</th>
                    <th>時間5</th>
                    <th>時間6</th>

                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>


    </div>



    <!-- 先載入 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
        integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2"
        crossorigin="anonymous"></script>
    <!-- datatable -->
    <script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.js"></script>
    <!-- 先載入 END-->

    <script>
        $(document).ready(function () {
            $.ajax({ //Process the form using $.ajax()
            type: 'get', //Method type
            url: 'https://opendata.cwb.gov.tw/fileapi/v1/opendataapi/O-A0002-001?Authorization=CWB-4EBAEEC1-2629-4C09-B0C7-9A75DA7A359B&downloadType=WEB&format=JSON', //Your form processing file URL
            data: $(this).serialize(), //Forms name
            dataType: 'json',
            success: function(result) {
                data=result.cwbopendata.location;
                console.log("縣市:",data[0].parameter[0].parameterValue);
                console.log("地名:",data[0].locationName);
                console.log("高度:",data[0].weatherElement[0].elementValue.value,"公尺");
                console.log("測量時間:",data[0].time.obsTime);
                console.log("60分鐘累積雨量:",data[0].weatherElement[1].elementValue.value,"mm");
                console.log("10分鐘累積雨量:",data[0].weatherElement[2].elementValue.value,"mm");
                console.log("3小時累積雨量:",data[0].weatherElement[3].elementValue.value,"mm");
                console.log("6小時累積雨量:",data[0].weatherElement[4].elementValue.value,"mm");
                console.log("12小時累積雨量:",data[0].weatherElement[5].elementValue.value,"mm");
                console.log("24小時累積雨量:",data[0].weatherElement[6].elementValue.value,"mm");
                console.log("本日累積雨量:",data[0].weatherElement[7].elementValue.value,"mm");
                console.log("前1日0時到現在之累積雨量:",data[0].weatherElement[8].elementValue.value,"mm");
                console.log("前2日0時到現在之累積雨量:",data[0].weatherElement[9].elementValue.value,"mm");
                // time0.getFullYear()
                time0=new Date(data[0].time.obsTime);
                console.log(time0);
                console.log("year",time0.getFullYear());
                console.log("month",time0.getMonth()+1);
                console.log("day",time0.getDate());
                console.log("hour",time0.getHours());
                console.log("資料筆數:",data.length);
                
                $("h1").prepend(`${time0.getFullYear()}/${time0.getMonth()+1}/${time0.getDate()}`);
                $("tr>th").eq(1).text(`縣市`)
                $("tr>th").eq(2).text(`地名`)
                $("tr>th").eq(3).text(`60分鐘累積雨量`)
                $("tr>th").eq(4).text(`3小時累積雨量`)
                $("tr>th").eq(5).text(`6小時累積雨量`)
                $("tr>th").eq(6).text(`12小時累積雨量`)
                $("tr>th").eq(7).text(`24小時累積雨量`)

                for(i=0;i<data.length;i++){
                    $("tbody").append(`
                    <tr>
                        <th>${i+1}</th>
                        <th>${data[i].parameter[0].parameterValue}</th>
                        <th>${data[i].locationName}</th>
                        <th>${data[i].weatherElement[1].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[3].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[4].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[5].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[6].elementValue.value}mm</th>
                    </tr>`);
                }

                const north=["新北市","臺北市","基隆市","新竹市","桃園市","新竹縣","宜蘭縣"];
                const mid=["臺中市","苗栗縣","彰化縣","南投縣","雲林縣"];
                const south=["高雄市","臺南市","嘉義市","嘉義縣","屏東縣","澎湖縣"];
                const east=["花蓮縣","臺東縣"];

                $("#north").on("click",function(){
                    $("tbody").html("");
                    $("h1").text(`${time0.getFullYear()}/${time0.getMonth()+1}/${time0.getDate()}北部地區累積降雨量`);
                    for(i=0;i<data.length;i++){
                        if(north.indexOf(data[i].parameter[0].parameterValue)>=0){
                        $("tbody").append(`
                    <tr>
                        <th>${i+1}</th>
                        <th>${data[i].parameter[0].parameterValue}</th>
                        <th>${data[i].locationName}</th>
                        <th>${data[i].weatherElement[1].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[3].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[4].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[5].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[6].elementValue.value}mm</th>
                    </tr>`);
                        }
                    }
                    
                })
                $("#mid").on("click",function(){
                    $("tbody").html("");
                    $("h1").text(`${time0.getFullYear()}/${time0.getMonth()+1}/${time0.getDate()}中部地區累積降雨量`);
                    for(i=0;i<data.length;i++){
                        if(mid.indexOf(data[i].parameter[0].parameterValue)>=0){
                        $("tbody").append(`
                    <tr>
                        <th>${i+1}</th>
                        <th>${data[i].parameter[0].parameterValue}</th>
                        <th>${data[i].locationName}</th>
                        <th>${data[i].weatherElement[1].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[3].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[4].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[5].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[6].elementValue.value}mm</th>
                    </tr>`);
                        }
                    }
                    
                })
                $("#south").on("click",function(){
                    $("tbody").html("");
                    $("h1").text(`${time0.getFullYear()}/${time0.getMonth()+1}/${time0.getDate()}南部地區累積降雨量`);
                    for(i=0;i<data.length;i++){
                        if(south.indexOf(data[i].parameter[0].parameterValue)>=0){
                        $("tbody").append(`
                    <tr>
                        <th>${i+1}</th>
                        <th>${data[i].parameter[0].parameterValue}</th>
                        <th>${data[i].locationName}</th>
                        <th>${data[i].weatherElement[1].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[3].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[4].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[5].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[6].elementValue.value}mm</th>
                    </tr>`);
                        }
                    }
                    
                })
                $("#east").on("click",function(){
                    $("tbody").html("");
                    $("h1").text(`${time0.getFullYear()}/${time0.getMonth()+1}/${time0.getDate()}東部地區累積降雨量`);
                    for(i=0;i<data.length;i++){
                        if(east.indexOf(data[i].parameter[0].parameterValue)>=0){
                        $("tbody").append(`
                    <tr>
                        <th>${i+1}</th>
                        <th>${data[i].parameter[0].parameterValue}</th>
                        <th>${data[i].locationName}</th>
                        <th>${data[i].weatherElement[1].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[3].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[4].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[5].elementValue.value}mm</th>
                        <th>${data[i].weatherElement[6].elementValue.value}mm</th>
                    </tr>`);
                        }
                    }
                    
                })
                $("#all").on("click",function(){
                    location.reload();
                    
                })
                $("#table_id").DataTable();

                
                
            }
            
                
            });
            
            
        });
        



    </script>


</body>

</html>